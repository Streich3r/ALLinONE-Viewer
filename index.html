<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <title>PDF Debug</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
</head>
<body>
  <h2>ðŸ“„ PDF Debug Test</h2>
  <input type="file" id="fileInput" />
  <div id="output"></div>

  <script src="pdf.min.js"></script>
  <script>
    // Worker definieren
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'pdf.worker.min.js';

    const fileInput = document.getElementById("fileInput");
    const output = document.getElementById("output");

    fileInput.addEventListener("change", async (e) => {
      const file = e.target.files[0];
      if (!file) {
        alert("Keine Datei gewÃ¤hlt");
        return;
      }
      alert("Datei gewÃ¤hlt: " + file.name);

      const reader = new FileReader();
      reader.onload = async () => {
        try {
          const data = new Uint8Array(reader.result);
          console.log("Starte PDF laden...");
          const pdf = await pdfjsLib.getDocument({ data }).promise;
          alert("PDF geladen: " + pdf.numPages + " Seiten");
          output.innerHTML = "";

          for (let i = 1; i <= pdf.numPages; i++) {
            const page = await pdf.getPage(i);
            const viewport = page.getViewport({ scale: 1.0 });
            const canvas = document.createElement("canvas");
            const ctx = canvas.getContext("2d");
            canvas.width = viewport.width;
            canvas.height = viewport.height;
            await page.render({ canvasContext: ctx, viewport }).promise;
            output.appendChild(canvas);
          }
        } catch (err) {
          console.error("PDF Fehler", err);
          alert("Fehler: " + err.message);
        }
      };
      reader.readAsArrayBuffer(file);
    });
  </script>
</body>
</html>
